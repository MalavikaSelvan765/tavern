load("@tavern_pip//:requirements.bzl", "requirement")
load("@rules_python//python:defs.bzl", "py_library")

py_library(
    name = "conftest",
    srcs = ["conftest.py"],
    data = [":logging.yaml"],
    imports = [".."],
    visibility = ["//visibility:public"],
    deps = [
        "//tavern",
        "//tavern/_plugins/mqtt",
        "//tavern/_plugins/rest",
        "@tavern_pip_pytest//:pkg",
        "@tavern_pip_pyyaml//:pkg",
        "@tavern_pip_stevedore//:pkg",
    ],
)

load("@com_github_ali5h_rules_pip//:defs.bzl", "py_pytest_test")

py_pytest_test(
    name = "test_doctest",
    args = [
        "-c",
        "pytest.ini",
        "--color",
        "yes",
        "--doctest-modules",
    ],
    data = ["//:pytest.ini"],
    deps = [":conftest"],
)
